-- Usuários
CREATE TABLE USERS (
  ID            NUMBER GENERATED ALWAYS AS IDENTITY,
  NAME          VARCHAR2(120) NOT NULL,
  EMAIL         VARCHAR2(200) UNIQUE NOT NULL,
  MONTHLY_INCOME NUMBER(12,2) DEFAULT 0,
  CREATED_AT    TIMESTAMP DEFAULT SYSTIMESTAMP,
  PRIMARY KEY (ID)
);

-- Transações (depósitos/saques ligados a apostas ou relacionados)
CREATE TABLE TRANSACTIONS (
  ID            NUMBER GENERATED ALWAYS AS IDENTITY,
  USER_ID       NUMBER NOT NULL,
  OPERATOR      VARCHAR2(120) NOT NULL, -- casa de apostas/operador
  KIND          VARCHAR2(30) NOT NULL,  -- "DEPOSIT" | "WITHDRAWAL" | "OTHER"
  AMOUNT        NUMBER(12,2) NOT NULL,
  OCCURRED_AT   TIMESTAMP NOT NULL,
  RAW_LABEL     VARCHAR2(300),          -- texto original do extrato
  CREATED_AT    TIMESTAMP DEFAULT SYSTIMESTAMP,
  PRIMARY KEY (ID),
  CONSTRAINT FK_TX_USER FOREIGN KEY (USER_ID) REFERENCES USERS(ID)
);

CREATE INDEX IX_TX_USER_DATE ON TRANSACTIONS (USER_ID, OCCURRED_AT);
